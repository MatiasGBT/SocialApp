{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/BELTARiT/Desktop/SocialApp/SocialApp_frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from '@angular/core';\nimport { Injectable, NgModule } from '@angular/core';\nimport { HttpHeaders, HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { Subject, from, combineLatest } from 'rxjs';\nimport { map, mergeMap } from 'rxjs/operators';\nimport Keycloak from 'keycloak-js';\nimport { CommonModule } from '@angular/common';\nvar KeycloakEventType;\n\n(function (KeycloakEventType) {\n  KeycloakEventType[KeycloakEventType[\"OnAuthError\"] = 0] = \"OnAuthError\";\n  KeycloakEventType[KeycloakEventType[\"OnAuthLogout\"] = 1] = \"OnAuthLogout\";\n  KeycloakEventType[KeycloakEventType[\"OnAuthRefreshError\"] = 2] = \"OnAuthRefreshError\";\n  KeycloakEventType[KeycloakEventType[\"OnAuthRefreshSuccess\"] = 3] = \"OnAuthRefreshSuccess\";\n  KeycloakEventType[KeycloakEventType[\"OnAuthSuccess\"] = 4] = \"OnAuthSuccess\";\n  KeycloakEventType[KeycloakEventType[\"OnReady\"] = 5] = \"OnReady\";\n  KeycloakEventType[KeycloakEventType[\"OnTokenExpired\"] = 6] = \"OnTokenExpired\";\n  KeycloakEventType[KeycloakEventType[\"OnActionUpdate\"] = 7] = \"OnActionUpdate\";\n})(KeycloakEventType || (KeycloakEventType = {}));\n\nclass KeycloakAuthGuard {\n  constructor(router, keycloakAngular) {\n    this.router = router;\n    this.keycloakAngular = keycloakAngular;\n  }\n\n  canActivate(route, state) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        _this.authenticated = yield _this.keycloakAngular.isLoggedIn();\n        _this.roles = yield _this.keycloakAngular.getUserRoles(true);\n        return yield _this.isAccessAllowed(route, state);\n      } catch (error) {\n        throw new Error('An error happened during access validation. Details:' + error);\n      }\n    })();\n  }\n\n}\n\nclass KeycloakService {\n  constructor() {\n    this._keycloakEvents$ = new Subject();\n  }\n\n  bindsKeycloakEvents() {\n    this._instance.onAuthError = errorData => {\n      this._keycloakEvents$.next({\n        args: errorData,\n        type: KeycloakEventType.OnAuthError\n      });\n    };\n\n    this._instance.onAuthLogout = () => {\n      this._keycloakEvents$.next({\n        type: KeycloakEventType.OnAuthLogout\n      });\n    };\n\n    this._instance.onAuthRefreshSuccess = () => {\n      this._keycloakEvents$.next({\n        type: KeycloakEventType.OnAuthRefreshSuccess\n      });\n    };\n\n    this._instance.onAuthRefreshError = () => {\n      this._keycloakEvents$.next({\n        type: KeycloakEventType.OnAuthRefreshError\n      });\n    };\n\n    this._instance.onAuthSuccess = () => {\n      this._keycloakEvents$.next({\n        type: KeycloakEventType.OnAuthSuccess\n      });\n    };\n\n    this._instance.onTokenExpired = () => {\n      this._keycloakEvents$.next({\n        type: KeycloakEventType.OnTokenExpired\n      });\n    };\n\n    this._instance.onActionUpdate = state => {\n      this._keycloakEvents$.next({\n        args: state,\n        type: KeycloakEventType.OnActionUpdate\n      });\n    };\n\n    this._instance.onReady = authenticated => {\n      this._keycloakEvents$.next({\n        args: authenticated,\n        type: KeycloakEventType.OnReady\n      });\n    };\n  }\n\n  loadExcludedUrls(bearerExcludedUrls) {\n    const excludedUrls = [];\n\n    for (const item of bearerExcludedUrls) {\n      let excludedUrl;\n\n      if (typeof item === 'string') {\n        excludedUrl = {\n          urlPattern: new RegExp(item, 'i'),\n          httpMethods: []\n        };\n      } else {\n        excludedUrl = {\n          urlPattern: new RegExp(item.url, 'i'),\n          httpMethods: item.httpMethods\n        };\n      }\n\n      excludedUrls.push(excludedUrl);\n    }\n\n    return excludedUrls;\n  }\n\n  initServiceValues({\n    enableBearerInterceptor = true,\n    loadUserProfileAtStartUp = false,\n    bearerExcludedUrls = [],\n    authorizationHeaderName = 'Authorization',\n    bearerPrefix = 'Bearer',\n    initOptions,\n    updateMinValidity = 20,\n    shouldAddToken = () => true,\n    shouldUpdateToken = () => true\n  }) {\n    this._enableBearerInterceptor = enableBearerInterceptor;\n    this._loadUserProfileAtStartUp = loadUserProfileAtStartUp;\n    this._authorizationHeaderName = authorizationHeaderName;\n    this._bearerPrefix = bearerPrefix.trim().concat(' ');\n    this._excludedUrls = this.loadExcludedUrls(bearerExcludedUrls);\n    this._silentRefresh = initOptions ? initOptions.flow === 'implicit' : false;\n    this._updateMinValidity = updateMinValidity;\n    this.shouldAddToken = shouldAddToken;\n    this.shouldUpdateToken = shouldUpdateToken;\n  }\n\n  init(options = {}) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      _this2.initServiceValues(options);\n\n      const {\n        config,\n        initOptions\n      } = options;\n      _this2._instance = Keycloak(config);\n\n      _this2.bindsKeycloakEvents();\n\n      const authenticated = yield _this2._instance.init(initOptions);\n\n      if (authenticated && _this2._loadUserProfileAtStartUp) {\n        yield _this2.loadUserProfile();\n      }\n\n      return authenticated;\n    })();\n  }\n\n  login(options = {}) {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this3._instance.login(options);\n\n      if (_this3._loadUserProfileAtStartUp) {\n        yield _this3.loadUserProfile();\n      }\n    })();\n  }\n\n  logout(redirectUri) {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      const options = {\n        redirectUri\n      };\n      yield _this4._instance.logout(options);\n      _this4._userProfile = undefined;\n    })();\n  }\n\n  register(options = {\n    action: 'register'\n  }) {\n    var _this5 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this5._instance.register(options);\n    })();\n  }\n\n  isUserInRole(role, resource) {\n    let hasRole;\n    hasRole = this._instance.hasResourceRole(role, resource);\n\n    if (!hasRole) {\n      hasRole = this._instance.hasRealmRole(role);\n    }\n\n    return hasRole;\n  }\n\n  getUserRoles(allRoles = true) {\n    let roles = [];\n\n    if (this._instance.resourceAccess) {\n      for (const key in this._instance.resourceAccess) {\n        if (this._instance.resourceAccess.hasOwnProperty(key)) {\n          const resourceAccess = this._instance.resourceAccess[key];\n          const clientRoles = resourceAccess['roles'] || [];\n          roles = roles.concat(clientRoles);\n        }\n      }\n    }\n\n    if (allRoles && this._instance.realmAccess) {\n      const realmRoles = this._instance.realmAccess['roles'] || [];\n      roles.push(...realmRoles);\n    }\n\n    return roles;\n  }\n\n  isLoggedIn() {\n    var _this6 = this;\n\n    return _asyncToGenerator(function* () {\n      if (!_this6._instance) {\n        return false;\n      }\n\n      return _this6._instance.authenticated;\n    })();\n  }\n\n  isTokenExpired(minValidity = 0) {\n    return this._instance.isTokenExpired(minValidity);\n  }\n\n  updateToken(minValidity = this._updateMinValidity) {\n    var _this7 = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        if (_this7._silentRefresh) {\n          if (_this7.isTokenExpired()) {\n            throw new Error('Failed to refresh the token, or the session is expired');\n          }\n\n          return true;\n        }\n\n        if (!_this7._instance) {\n          throw new Error('Keycloak Angular library is not initialized.');\n        }\n\n        return yield _this7._instance.updateToken(minValidity);\n      } catch (error) {\n        return false;\n      }\n    })();\n  }\n\n  loadUserProfile(forceReload = false) {\n    var _this8 = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this8._userProfile && !forceReload) {\n        return _this8._userProfile;\n      }\n\n      if (!_this8._instance.authenticated) {\n        throw new Error('The user profile was not loaded as the user is not logged in.');\n      }\n\n      return _this8._userProfile = yield _this8._instance.loadUserProfile();\n    })();\n  }\n\n  getToken() {\n    var _this9 = this;\n\n    return _asyncToGenerator(function* () {\n      return _this9._instance.token;\n    })();\n  }\n\n  getUsername() {\n    if (!this._userProfile) {\n      throw new Error('User not logged in or user profile was not loaded.');\n    }\n\n    return this._userProfile.username;\n  }\n\n  clearToken() {\n    this._instance.clearToken();\n  }\n\n  addTokenToHeader(headers = new HttpHeaders()) {\n    return from(this.getToken()).pipe(map(token => token ? headers.set(this._authorizationHeaderName, this._bearerPrefix + token) : headers));\n  }\n\n  getKeycloakInstance() {\n    return this._instance;\n  }\n\n  get excludedUrls() {\n    return this._excludedUrls;\n  }\n\n  get enableBearerInterceptor() {\n    return this._enableBearerInterceptor;\n  }\n\n  get keycloakEvents$() {\n    return this._keycloakEvents$;\n  }\n\n}\n\nKeycloakService.ɵfac = function KeycloakService_Factory(t) {\n  return new (t || KeycloakService)();\n};\n\nKeycloakService.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: KeycloakService,\n  factory: KeycloakService.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(KeycloakService, [{\n    type: Injectable\n  }], null, null);\n})();\n\nclass KeycloakBearerInterceptor {\n  constructor(keycloak) {\n    this.keycloak = keycloak;\n  }\n\n  conditionallyUpdateToken(req) {\n    var _this10 = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this10.keycloak.shouldUpdateToken(req)) {\n        return yield _this10.keycloak.updateToken();\n      }\n\n      return true;\n    })();\n  }\n\n  isUrlExcluded({\n    method,\n    url\n  }, {\n    urlPattern,\n    httpMethods\n  }) {\n    const httpTest = httpMethods.length === 0 || httpMethods.join().indexOf(method.toUpperCase()) > -1;\n    const urlTest = urlPattern.test(url);\n    return httpTest && urlTest;\n  }\n\n  intercept(req, next) {\n    const {\n      enableBearerInterceptor,\n      excludedUrls\n    } = this.keycloak;\n\n    if (!enableBearerInterceptor) {\n      return next.handle(req);\n    }\n\n    const shallPass = !this.keycloak.shouldAddToken(req) || excludedUrls.findIndex(item => this.isUrlExcluded(req, item)) > -1;\n\n    if (shallPass) {\n      return next.handle(req);\n    }\n\n    return combineLatest([this.conditionallyUpdateToken(req), this.keycloak.isLoggedIn()]).pipe(mergeMap(([_, isLoggedIn]) => isLoggedIn ? this.handleRequestWithTokenHeader(req, next) : next.handle(req)));\n  }\n\n  handleRequestWithTokenHeader(req, next) {\n    return this.keycloak.addTokenToHeader(req.headers).pipe(mergeMap(headersWithBearer => {\n      const kcReq = req.clone({\n        headers: headersWithBearer\n      });\n      return next.handle(kcReq);\n    }));\n  }\n\n}\n\nKeycloakBearerInterceptor.ɵfac = function KeycloakBearerInterceptor_Factory(t) {\n  return new (t || KeycloakBearerInterceptor)(i0.ɵɵinject(KeycloakService));\n};\n\nKeycloakBearerInterceptor.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: KeycloakBearerInterceptor,\n  factory: KeycloakBearerInterceptor.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(KeycloakBearerInterceptor, [{\n    type: Injectable\n  }], function () {\n    return [{\n      type: KeycloakService\n    }];\n  }, null);\n})();\n\nclass CoreModule {}\n\nCoreModule.ɵfac = function CoreModule_Factory(t) {\n  return new (t || CoreModule)();\n};\n\nCoreModule.ɵmod = /* @__PURE__ */i0.ɵɵdefineNgModule({\n  type: CoreModule\n});\nCoreModule.ɵinj = /* @__PURE__ */i0.ɵɵdefineInjector({\n  providers: [KeycloakService, {\n    provide: HTTP_INTERCEPTORS,\n    useClass: KeycloakBearerInterceptor,\n    multi: true\n  }],\n  imports: [CommonModule]\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(CoreModule, [{\n    type: NgModule,\n    args: [{\n      imports: [CommonModule],\n      providers: [KeycloakService, {\n        provide: HTTP_INTERCEPTORS,\n        useClass: KeycloakBearerInterceptor,\n        multi: true\n      }]\n    }]\n  }], null, null);\n})();\n\nclass KeycloakAngularModule {}\n\nKeycloakAngularModule.ɵfac = function KeycloakAngularModule_Factory(t) {\n  return new (t || KeycloakAngularModule)();\n};\n\nKeycloakAngularModule.ɵmod = /* @__PURE__ */i0.ɵɵdefineNgModule({\n  type: KeycloakAngularModule\n});\nKeycloakAngularModule.ɵinj = /* @__PURE__ */i0.ɵɵdefineInjector({\n  imports: [CoreModule]\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(KeycloakAngularModule, [{\n    type: NgModule,\n    args: [{\n      imports: [CoreModule]\n    }]\n  }], null, null);\n})();\n\nexport { CoreModule, KeycloakAngularModule, KeycloakAuthGuard, KeycloakBearerInterceptor, KeycloakEventType, KeycloakService };","map":{"version":3,"names":["i0","Injectable","NgModule","HttpHeaders","HTTP_INTERCEPTORS","Subject","from","combineLatest","map","mergeMap","Keycloak","CommonModule","KeycloakEventType","KeycloakAuthGuard","constructor","router","keycloakAngular","canActivate","route","state","authenticated","isLoggedIn","roles","getUserRoles","isAccessAllowed","error","Error","KeycloakService","_keycloakEvents$","bindsKeycloakEvents","_instance","onAuthError","errorData","next","args","type","OnAuthError","onAuthLogout","OnAuthLogout","onAuthRefreshSuccess","OnAuthRefreshSuccess","onAuthRefreshError","OnAuthRefreshError","onAuthSuccess","OnAuthSuccess","onTokenExpired","OnTokenExpired","onActionUpdate","OnActionUpdate","onReady","OnReady","loadExcludedUrls","bearerExcludedUrls","excludedUrls","item","excludedUrl","urlPattern","RegExp","httpMethods","url","push","initServiceValues","enableBearerInterceptor","loadUserProfileAtStartUp","authorizationHeaderName","bearerPrefix","initOptions","updateMinValidity","shouldAddToken","shouldUpdateToken","_enableBearerInterceptor","_loadUserProfileAtStartUp","_authorizationHeaderName","_bearerPrefix","trim","concat","_excludedUrls","_silentRefresh","flow","_updateMinValidity","init","options","config","loadUserProfile","login","logout","redirectUri","_userProfile","undefined","register","action","isUserInRole","role","resource","hasRole","hasResourceRole","hasRealmRole","allRoles","resourceAccess","key","hasOwnProperty","clientRoles","realmAccess","realmRoles","isTokenExpired","minValidity","updateToken","forceReload","getToken","token","getUsername","username","clearToken","addTokenToHeader","headers","pipe","set","getKeycloakInstance","keycloakEvents$","ɵfac","ɵprov","KeycloakBearerInterceptor","keycloak","conditionallyUpdateToken","req","isUrlExcluded","method","httpTest","length","join","indexOf","toUpperCase","urlTest","test","intercept","handle","shallPass","findIndex","_","handleRequestWithTokenHeader","headersWithBearer","kcReq","clone","CoreModule","ɵmod","ɵinj","provide","useClass","multi","imports","providers","KeycloakAngularModule"],"sources":["C:/Users/BELTARiT/Desktop/SocialApp/SocialApp_frontend/node_modules/keycloak-angular/fesm2020/keycloak-angular.mjs"],"sourcesContent":["import * as i0 from '@angular/core';\nimport { Injectable, NgModule } from '@angular/core';\nimport { HttpHeaders, HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { Subject, from, combineLatest } from 'rxjs';\nimport { map, mergeMap } from 'rxjs/operators';\nimport Keycloak from 'keycloak-js';\nimport { CommonModule } from '@angular/common';\n\nvar KeycloakEventType;\n(function (KeycloakEventType) {\n    KeycloakEventType[KeycloakEventType[\"OnAuthError\"] = 0] = \"OnAuthError\";\n    KeycloakEventType[KeycloakEventType[\"OnAuthLogout\"] = 1] = \"OnAuthLogout\";\n    KeycloakEventType[KeycloakEventType[\"OnAuthRefreshError\"] = 2] = \"OnAuthRefreshError\";\n    KeycloakEventType[KeycloakEventType[\"OnAuthRefreshSuccess\"] = 3] = \"OnAuthRefreshSuccess\";\n    KeycloakEventType[KeycloakEventType[\"OnAuthSuccess\"] = 4] = \"OnAuthSuccess\";\n    KeycloakEventType[KeycloakEventType[\"OnReady\"] = 5] = \"OnReady\";\n    KeycloakEventType[KeycloakEventType[\"OnTokenExpired\"] = 6] = \"OnTokenExpired\";\n    KeycloakEventType[KeycloakEventType[\"OnActionUpdate\"] = 7] = \"OnActionUpdate\";\n})(KeycloakEventType || (KeycloakEventType = {}));\n\nclass KeycloakAuthGuard {\n    constructor(router, keycloakAngular) {\n        this.router = router;\n        this.keycloakAngular = keycloakAngular;\n    }\n    async canActivate(route, state) {\n        try {\n            this.authenticated = await this.keycloakAngular.isLoggedIn();\n            this.roles = await this.keycloakAngular.getUserRoles(true);\n            return await this.isAccessAllowed(route, state);\n        }\n        catch (error) {\n            throw new Error('An error happened during access validation. Details:' + error);\n        }\n    }\n}\n\nclass KeycloakService {\n    constructor() {\n        this._keycloakEvents$ = new Subject();\n    }\n    bindsKeycloakEvents() {\n        this._instance.onAuthError = (errorData) => {\n            this._keycloakEvents$.next({\n                args: errorData,\n                type: KeycloakEventType.OnAuthError\n            });\n        };\n        this._instance.onAuthLogout = () => {\n            this._keycloakEvents$.next({ type: KeycloakEventType.OnAuthLogout });\n        };\n        this._instance.onAuthRefreshSuccess = () => {\n            this._keycloakEvents$.next({\n                type: KeycloakEventType.OnAuthRefreshSuccess\n            });\n        };\n        this._instance.onAuthRefreshError = () => {\n            this._keycloakEvents$.next({\n                type: KeycloakEventType.OnAuthRefreshError\n            });\n        };\n        this._instance.onAuthSuccess = () => {\n            this._keycloakEvents$.next({ type: KeycloakEventType.OnAuthSuccess });\n        };\n        this._instance.onTokenExpired = () => {\n            this._keycloakEvents$.next({\n                type: KeycloakEventType.OnTokenExpired\n            });\n        };\n        this._instance.onActionUpdate = (state) => {\n            this._keycloakEvents$.next({\n                args: state,\n                type: KeycloakEventType.OnActionUpdate\n            });\n        };\n        this._instance.onReady = (authenticated) => {\n            this._keycloakEvents$.next({\n                args: authenticated,\n                type: KeycloakEventType.OnReady\n            });\n        };\n    }\n    loadExcludedUrls(bearerExcludedUrls) {\n        const excludedUrls = [];\n        for (const item of bearerExcludedUrls) {\n            let excludedUrl;\n            if (typeof item === 'string') {\n                excludedUrl = { urlPattern: new RegExp(item, 'i'), httpMethods: [] };\n            }\n            else {\n                excludedUrl = {\n                    urlPattern: new RegExp(item.url, 'i'),\n                    httpMethods: item.httpMethods\n                };\n            }\n            excludedUrls.push(excludedUrl);\n        }\n        return excludedUrls;\n    }\n    initServiceValues({ enableBearerInterceptor = true, loadUserProfileAtStartUp = false, bearerExcludedUrls = [], authorizationHeaderName = 'Authorization', bearerPrefix = 'Bearer', initOptions, updateMinValidity = 20, shouldAddToken = () => true, shouldUpdateToken = () => true }) {\n        this._enableBearerInterceptor = enableBearerInterceptor;\n        this._loadUserProfileAtStartUp = loadUserProfileAtStartUp;\n        this._authorizationHeaderName = authorizationHeaderName;\n        this._bearerPrefix = bearerPrefix.trim().concat(' ');\n        this._excludedUrls = this.loadExcludedUrls(bearerExcludedUrls);\n        this._silentRefresh = initOptions ? initOptions.flow === 'implicit' : false;\n        this._updateMinValidity = updateMinValidity;\n        this.shouldAddToken = shouldAddToken;\n        this.shouldUpdateToken = shouldUpdateToken;\n    }\n    async init(options = {}) {\n        this.initServiceValues(options);\n        const { config, initOptions } = options;\n        this._instance = Keycloak(config);\n        this.bindsKeycloakEvents();\n        const authenticated = await this._instance.init(initOptions);\n        if (authenticated && this._loadUserProfileAtStartUp) {\n            await this.loadUserProfile();\n        }\n        return authenticated;\n    }\n    async login(options = {}) {\n        await this._instance.login(options);\n        if (this._loadUserProfileAtStartUp) {\n            await this.loadUserProfile();\n        }\n    }\n    async logout(redirectUri) {\n        const options = {\n            redirectUri\n        };\n        await this._instance.logout(options);\n        this._userProfile = undefined;\n    }\n    async register(options = { action: 'register' }) {\n        await this._instance.register(options);\n    }\n    isUserInRole(role, resource) {\n        let hasRole;\n        hasRole = this._instance.hasResourceRole(role, resource);\n        if (!hasRole) {\n            hasRole = this._instance.hasRealmRole(role);\n        }\n        return hasRole;\n    }\n    getUserRoles(allRoles = true) {\n        let roles = [];\n        if (this._instance.resourceAccess) {\n            for (const key in this._instance.resourceAccess) {\n                if (this._instance.resourceAccess.hasOwnProperty(key)) {\n                    const resourceAccess = this._instance.resourceAccess[key];\n                    const clientRoles = resourceAccess['roles'] || [];\n                    roles = roles.concat(clientRoles);\n                }\n            }\n        }\n        if (allRoles && this._instance.realmAccess) {\n            const realmRoles = this._instance.realmAccess['roles'] || [];\n            roles.push(...realmRoles);\n        }\n        return roles;\n    }\n    async isLoggedIn() {\n        if (!this._instance) {\n            return false;\n        }\n        return this._instance.authenticated;\n    }\n    isTokenExpired(minValidity = 0) {\n        return this._instance.isTokenExpired(minValidity);\n    }\n    async updateToken(minValidity = this._updateMinValidity) {\n        try {\n            if (this._silentRefresh) {\n                if (this.isTokenExpired()) {\n                    throw new Error('Failed to refresh the token, or the session is expired');\n                }\n                return true;\n            }\n            if (!this._instance) {\n                throw new Error('Keycloak Angular library is not initialized.');\n            }\n            return await this._instance.updateToken(minValidity);\n        }\n        catch (error) {\n            return false;\n        }\n    }\n    async loadUserProfile(forceReload = false) {\n        if (this._userProfile && !forceReload) {\n            return this._userProfile;\n        }\n        if (!this._instance.authenticated) {\n            throw new Error('The user profile was not loaded as the user is not logged in.');\n        }\n        return (this._userProfile = await this._instance.loadUserProfile());\n    }\n    async getToken() {\n        return this._instance.token;\n    }\n    getUsername() {\n        if (!this._userProfile) {\n            throw new Error('User not logged in or user profile was not loaded.');\n        }\n        return this._userProfile.username;\n    }\n    clearToken() {\n        this._instance.clearToken();\n    }\n    addTokenToHeader(headers = new HttpHeaders()) {\n        return from(this.getToken()).pipe(map((token) => token\n            ? headers.set(this._authorizationHeaderName, this._bearerPrefix + token)\n            : headers));\n    }\n    getKeycloakInstance() {\n        return this._instance;\n    }\n    get excludedUrls() {\n        return this._excludedUrls;\n    }\n    get enableBearerInterceptor() {\n        return this._enableBearerInterceptor;\n    }\n    get keycloakEvents$() {\n        return this._keycloakEvents$;\n    }\n}\nKeycloakService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"14.0.5\", ngImport: i0, type: KeycloakService, deps: [], target: i0.ɵɵFactoryTarget.Injectable });\nKeycloakService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"14.0.5\", ngImport: i0, type: KeycloakService });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"14.0.5\", ngImport: i0, type: KeycloakService, decorators: [{\n            type: Injectable\n        }] });\n\nclass KeycloakBearerInterceptor {\n    constructor(keycloak) {\n        this.keycloak = keycloak;\n    }\n    async conditionallyUpdateToken(req) {\n        if (this.keycloak.shouldUpdateToken(req)) {\n            return await this.keycloak.updateToken();\n        }\n        return true;\n    }\n    isUrlExcluded({ method, url }, { urlPattern, httpMethods }) {\n        const httpTest = httpMethods.length === 0 ||\n            httpMethods.join().indexOf(method.toUpperCase()) > -1;\n        const urlTest = urlPattern.test(url);\n        return httpTest && urlTest;\n    }\n    intercept(req, next) {\n        const { enableBearerInterceptor, excludedUrls } = this.keycloak;\n        if (!enableBearerInterceptor) {\n            return next.handle(req);\n        }\n        const shallPass = !this.keycloak.shouldAddToken(req) ||\n            excludedUrls.findIndex((item) => this.isUrlExcluded(req, item)) > -1;\n        if (shallPass) {\n            return next.handle(req);\n        }\n        return combineLatest([\n            this.conditionallyUpdateToken(req),\n            this.keycloak.isLoggedIn()\n        ]).pipe(mergeMap(([_, isLoggedIn]) => isLoggedIn\n            ? this.handleRequestWithTokenHeader(req, next)\n            : next.handle(req)));\n    }\n    handleRequestWithTokenHeader(req, next) {\n        return this.keycloak.addTokenToHeader(req.headers).pipe(mergeMap((headersWithBearer) => {\n            const kcReq = req.clone({ headers: headersWithBearer });\n            return next.handle(kcReq);\n        }));\n    }\n}\nKeycloakBearerInterceptor.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"14.0.5\", ngImport: i0, type: KeycloakBearerInterceptor, deps: [{ token: KeycloakService }], target: i0.ɵɵFactoryTarget.Injectable });\nKeycloakBearerInterceptor.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"14.0.5\", ngImport: i0, type: KeycloakBearerInterceptor });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"14.0.5\", ngImport: i0, type: KeycloakBearerInterceptor, decorators: [{\n            type: Injectable\n        }], ctorParameters: function () { return [{ type: KeycloakService }]; } });\n\nclass CoreModule {\n}\nCoreModule.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"14.0.5\", ngImport: i0, type: CoreModule, deps: [], target: i0.ɵɵFactoryTarget.NgModule });\nCoreModule.ɵmod = i0.ɵɵngDeclareNgModule({ minVersion: \"14.0.0\", version: \"14.0.5\", ngImport: i0, type: CoreModule, imports: [CommonModule] });\nCoreModule.ɵinj = i0.ɵɵngDeclareInjector({ minVersion: \"12.0.0\", version: \"14.0.5\", ngImport: i0, type: CoreModule, providers: [\n        KeycloakService,\n        {\n            provide: HTTP_INTERCEPTORS,\n            useClass: KeycloakBearerInterceptor,\n            multi: true\n        }\n    ], imports: [CommonModule] });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"14.0.5\", ngImport: i0, type: CoreModule, decorators: [{\n            type: NgModule,\n            args: [{\n                    imports: [CommonModule],\n                    providers: [\n                        KeycloakService,\n                        {\n                            provide: HTTP_INTERCEPTORS,\n                            useClass: KeycloakBearerInterceptor,\n                            multi: true\n                        }\n                    ]\n                }]\n        }] });\n\nclass KeycloakAngularModule {\n}\nKeycloakAngularModule.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"14.0.5\", ngImport: i0, type: KeycloakAngularModule, deps: [], target: i0.ɵɵFactoryTarget.NgModule });\nKeycloakAngularModule.ɵmod = i0.ɵɵngDeclareNgModule({ minVersion: \"14.0.0\", version: \"14.0.5\", ngImport: i0, type: KeycloakAngularModule, imports: [CoreModule] });\nKeycloakAngularModule.ɵinj = i0.ɵɵngDeclareInjector({ minVersion: \"12.0.0\", version: \"14.0.5\", ngImport: i0, type: KeycloakAngularModule, imports: [CoreModule] });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"14.0.5\", ngImport: i0, type: KeycloakAngularModule, decorators: [{\n            type: NgModule,\n            args: [{\n                    imports: [CoreModule]\n                }]\n        }] });\n\nexport { CoreModule, KeycloakAngularModule, KeycloakAuthGuard, KeycloakBearerInterceptor, KeycloakEventType, KeycloakService };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}